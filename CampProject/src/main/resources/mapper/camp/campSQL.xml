<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="camp">
	<select id="selectList" parameterType="map" resultType="camp">		
		select
    		rnum,
    		campNo,
   			campName,
    		campAddr,
    		memberNo,
    		campShow,
    		campType,
    		campPh,
    		campPeriod,
    		campDay,
    		campFacility,
    		campFeeOriDay,
    		campFeeOriEnd,
    		campFeePeakDay,
    		campFeePeakEnd
			from
        		(select rownum as rnum, n.*
		from
		(select
			camp_no as campNo,
			camp_name as campName,
			camp_addr as campAddr,
			member_no as memberNo,
			camp_show as campShow,
			camp_type as campType,
			camp_ph as campPh,
			camp_period as campPeriod,
			camp_day as campDay,
			camp_facility as campFacility,
			camp_fee_ori_day as campFeeOriDay,
			camp_fee_ori_end as campFeeOriEnd,
			camp_fee_peak_day as campFeePeakDay,
			camp_fee_peak_end as campFeePeakEnd
		from camp order by 1 desc)
		n)
           where rnum between #{start} and #{end}
	</select>
	<select id="totalCount" resultType="_int">
		select count(camp_no) as cnt from camp
	</select>
	<select id="selectOne" parameterType="camp" resultType="camp">
		select 
          	camp_no as campNo,
			camp_name as campName,
			camp_addr as campAddr,
			member_no as memberNo,
			camp_show as campShow,
			camp_type as campType,
			camp_ph as campPh,
			camp_period as campPeriod,
			camp_day as campDay,
			camp_facility as campFacility,
			camp_fee_ori_day as campFeeOriDay,
			camp_fee_ori_end as campFeeOriEnd,
			camp_fee_peak_day as campFeePeakDay,
			camp_fee_peak_end as campFeePeakEnd
        from camp 
        <trim prefix="where" prefixOverrides="and|or">
		  	<if test="campNo != 0">
				 camp_no=#{campNo}
		  	</if>		  	
		  </trim>
	</select>
	<select id="selectPictureList" parameterType="map" resultType="campPicture">
		select
			pict_no as pictNo,
			camp_no as campNo,
			filename ,
			filepath ,
			filegrade
		from camp_picture
		<trim prefix="where" prefixOverrides="and|or">
		  	<if test="campNo != 0">
				 camp_no=#{campNo}
		  	</if>
		  	<if test="filegrade != 0">
		  		and filegrade = #{filegrade}
		  	</if>  	
		  </trim>
	</select>
	
	
	<select id="selectSiteList" parameterType="site" resultType="site">
		select
			*
		from site
		<trim prefix="where" prefixOverrides="and|or">
		  	<if test="campNo != 0">
				 camp_no=#{campNo}
		  	</if>
		  	<if test="reserveDate != null">
		  		and reserve_date = #{reserveDate}
		  	</if>  	
		  </trim>
	</select>
	<select id="reserveTotalCount" parameterType="site" resultType="_int">
		select 
			count(distinct site_name) 
		from site
		<trim prefix="where" prefixOverrides="and|or">
			<if test="campNo != 0">
				 camp_no=#{campNo}
		  	</if>
		</trim>
	</select>
	
	<select id="selectCampNoticeList" parameterType="map" resultType="cNotice">		
		select
    		rnum,
    		campNoticeNo,
			campNo,
			campNoticeTitle,
			campNoticeWriter,
			campNoticeContent,
			campNoticeDate
			from
        		(select rownum as rnum, n.*
					from
					(select
						camp_notice_no as campNoticeNo,
						camp_no as campNo,
						camp_notice_title as campNoticeTitle,
						camp_notice_writer as campNoticeWriter,
						camp_notice_content as campNoticeContent,
						camp_notice_date as campNoticeDate
					from camp_notice where camp_no=#{campNo} order by 1 desc)
				n)
        where rnum between #{start} and #{end}
	</select>
	<select id="cNoticetotalCount" parameterType="_int" resultType="_int">
		select count(camp_notice_no) as cnt from camp_notice where camp_no=#{_parameter}
	</select>
</mapper>
